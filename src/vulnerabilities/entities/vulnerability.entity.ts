import { Column, Entity, ManyToOne, PrimaryGeneratedColumn } from 'typeorm';
import { Device } from 'src/devices/entities/device.entity';

@Entity({ name: 'smart_home_vulnerabilities' })
export class Vulnerability {
  @PrimaryGeneratedColumn()
  id: number;

  @Column({ unique: true, nullable: true })
  cveId: string;

  @Column({ type: 'text', nullable: true })
  vulnerability: string;

  @Column({ type: 'text', nullable: true })
  impact: string;

  @Column({ type: 'text', nullable: true })
  lastModified: string;

  @Column({ type: 'text', nullable: true })
  vulnStatus: string;

  @Column({ type: 'json', nullable: true })
  metrics: any[];

  @Column({ type: 'text', nullable: true })
  threats: string;

  @Column({ type: 'text', nullable: true })
  recommendations: string;

  @Column({ type: 'simple-array', nullable: true })
  references: string[];

  @ManyToOne(() => Device, (device) => device.vulnerabilities, {
    onDelete: 'CASCADE',
  })
  device: Device;
}
